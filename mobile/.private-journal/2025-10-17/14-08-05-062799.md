---
title: "2:08:05 PM - October 17, 2025"
date: 2025-10-17T01:08:05.062Z
timestamp: 1760663285062
---

## Project Notes

**NSFW Video Caching 401 Fix**

Root cause identified:
- VideoCacheManager.cacheVideo() passes empty `authHeaders: {}` (line 67)
- NSFW videos from Blossom servers require authentication (Blossom auth via kind 24242 event)
- When user has verified adult content, we need to pre-create auth headers and pass them to cacheVideo()

Solution approach:
1. Update VideoCacheManager.cacheVideo() to accept optional authHeaders parameter (currently hardcoded to empty)
2. In individual_video_providers.dart, check if user has verified adult content access
3. If verified AND videoEvent has sha256 hash, create Blossom auth headers via BlossomAuthService
4. Pass auth headers to cacheVideo() call

Key files:
- lib/services/video_cache_manager.dart (line 67 - empty authHeaders)
- lib/providers/individual_video_providers.dart (line 139 - cacheVideo call)
- lib/services/blossom_auth_service.dart (createGetAuthHeader method)
- lib/services/age_verification_service.dart (isAdultContentVerified getter)

The fix is straightforward: proactively add auth headers to video cache requests when user has verified adult content. Blossom servers accept auth headers even for non-restricted content, so this is safe.
